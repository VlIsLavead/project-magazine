# Структура приложений интернет-магазина

## Обзор

```
project_magazine/
├── project_magazine/     # настройки проекта
├── catalog/              # каталог товаров
├── cart/                 # корзина
├── orders/               # заказы
├── accounts/             # пользователи и профили
├── core/                 # общее: шаблоны, утилиты, миксины
└── docs/                 # документация (этот файл)
```

---

## 1. `catalog` — Каталог товаров

**Назначение:** Всё, что связано с товарами и категориями: просмотр, поиск, фильтрация.

**Модели:**
- **Category** — категория товаров (название, slug, родитель для вложенности, порядок, активна/не активна).
- **Product** — товар (название, slug, описание, цена, скидка, изображение, категория, бренд, остаток, активен, даты создания/обновления).
- **ProductImage** (опционально) — несколько фото у одного товара.
- **Brand** (опционально) — бренд, если нужна фильтрация по брендам.

**Представления (views):**
- Список категорий / товаров в категории.
- Детальная страница товара.
- Поиск по названию/описанию.
- Фильтры (по цене, бренду, наличию) — можно добавить позже.

**Шаблоны:**
- Базовый список товаров (сетка карточек).
- Страница товара (фото, цена, описание, кнопка «В корзину»).
- Блок категорий в сайдбаре или меню.

**URL-ы:** например `/`, `/catalog/`, `/catalog/<slug:category_slug>/`, `/product/<slug:slug>/`, `/search/`.

---

## 2. `cart` — Корзина

**Назначение:** Хранение выбранных товаров до оформления заказа. Работа с сессией (или с пользователем, если авторизован).

**Модели:**
- Обычно **без моделей** на первом этапе — корзина в `request.session` (товар id + количество).
- Либо **Cart**, **CartItem** — если нужна постоянная корзина для залогиненных пользователей (синхронизация между устройствами).

**Логика:**
- Добавить в корзину (product_id, quantity).
- Изменить количество, удалить позицию.
- Подсчёт суммы корзины, количества позиций.
- Контекст-процессор, чтобы в шапке показывать «Корзина (N)» на всех страницах.

**Представления:**
- Просмотр корзины (страница с таблицей/списком и кнопкой «Оформить заказ»).
- AJAX или обычные формы для добавления/обновления/удаления (на твой выбор).

**Шаблоны:**
- `cart/cart_detail.html` — страница корзины.

**URL-ы:** `/cart/`, `/cart/add/<int:product_id>/`, `/cart/update/`, `/cart/remove/<int:product_id>/`.

---

## 3. `orders` — Заказы

**Назначение:** Оформление заказа, сохранение в БД, история заказов, статусы.

**Модели:**
- **Order** — заказ: пользователь (или null для гостя), статус, ФИО, email, телефон, адрес доставки, способ доставки/оплаты, сумма, дата создания, комментарий.
- **OrderItem** — позиция заказа: ссылка на Order, Product, цена на момент заказа, количество, сумма по позиции.

**Представления:**
- Форма оформления заказа (контакты + адрес), создание Order и OrderItem из корзины, очистка корзины, редирект на «Спасибо за заказ».
- Для авторизованных: страница «Мои заказы» и «Детали заказа».

**Шаблоны:**
- Форма заказа (checkout).
- Страница «Заказ оформлен».
- Список заказов пользователя и детали одного заказа.

**URL-ы:** `/order/checkout/`, `/order/thanks/<id>/`, `/orders/` (мои заказы), `/orders/<id>/`.

**Админка:** Управление заказами, смена статуса (новый, оплачен, отправлен, доставлен, отменён).

---

## 4. `accounts` — Пользователи и профили

**Назначение:** Регистрация, вход/выход, профиль покупателя, смена пароля. Опционально — восстановление пароля.

**Модели:**
- **User** — стандартная модель Django `django.contrib.auth.models.User` (или кастомная, если нужен email как логин).
- **Profile** (опционально) — расширение: телефон, адрес по умолчанию, аватар и т.п. (OneToOne с User).

**Представления:**
- Регистрация, вход, выход (можно через встроенные view или свои).
- Профиль: просмотр и редактирование (имя, email, телефон, адрес).
- Смена пароля.

**Шаблоны:**
- Регистрация, вход, профиль, смена пароля.
- Блок в шапке: «Войти» / «Выйти, имя».

**URL-ы:** `/accounts/register/`, `/accounts/login/`, `/accounts/logout/`, `/accounts/profile/`, `/accounts/profile/edit/`, `/accounts/password/`.

---

## 5. `core` — Общее

**Назначение:** Переиспользуемые части: базовый layout, утилиты, миксины, контекст-процессоры (не привязанные к одному приложению).

**Содержимое:**
- **Шаблоны:** `base.html` (общий каркас: шапка, меню, корзина в шапке, подвал), блоки для наследования.
- **Контекст-процессор:** например, количество товаров в корзине для отображения в шапке (если не выносить в `cart`).
- **Миксины:** например, доступ только для авторизованных, проверка владельца заказа.
- **Утилиты:** форматирование цены, общие фильтры/теги для шаблонов.
- **Статика:** общие CSS/JS (или ссылки на CDN Bootstrap и т.п.).

**Моделей нет.** Только шаблоны, контекст-процессоры, миксины, теги, фильтры.

**URL-ы:** главная страница `/` может отдаваться из `core` (редирект на каталог) или из `catalog`.

---

## Порядок внедрения

1. **core** — базовый шаблон и общие настройки.
2. **catalog** — модели, админка, список и деталь товара.
3. **cart** — корзина в сессии, страница корзины, кнопка «В корзину».
4. **orders** — оформление заказа, сохранение в БД, страница «Спасибо».
5. **accounts** — регистрация, вход, профиль, привязка заказов к пользователю.

После этого можно добавлять: оплату, доставку, отзывы, избранное, сравнение — отдельными приложениями или расширением существующих.
